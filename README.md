## 项目概述
### 基于STM32F103C8T6，通过时间控制实现电推杆的定位控制
### 当前方案是通过时间来控制电推杆行进，待改进
## 硬件清单
1. 控制器
   - MCU: STM32F103C8T6 (最小系统板)
   - 工作电压: 3.3V
   - 晶振: 8MHz

2. 执行机构
   - 电推杆: 24V直流电推杆
   - 额定电流: ≤3A
   - 行程: 200mm
   - 推力: ≥1000N

3. 电源系统
   - 输入: 220VAC家用电源
   - 防水插头: 三芯防水插头(10A/250V)
   - 漏电保护器: 2P 16A/30mA
   - 空气开关: 2P 10A C型
   - 开关电源: 24V/5A
   - 降压模块: AMS1117-5.0

4. 控制部件
   - 继电器: HF2100-1A-24DE (2个)
     * 线圈电压: 24V DC
     * 触点容量: 10A/250VAC
   - 按钮开关: 防水按钮（3个）
     * 上升按钮：常开
     * 下降按钮：常开
     * 停止按钮：常开

### 电源系统接线表
| 源端         | 目标端        | 电压  | 电流   | 线径建议 | 备注 |
|-------------|--------------|-------|--------|---------|------|
| 市电火线(L)  | 漏电保护器L端 | 220V  | ≤5A    | 1.0mm² | 棕色 |
| 市电零线(N)  | 漏电保护器N端 | 220V  | ≤5A    | 1.0mm² | 蓝色 |
| 市电地线(PE) | 接地端子      | -     | -      | 1.0mm² | 黄绿 |
| 漏电保护器输出| 空气开关输入  | 220V  | ≤5A    | 1.0mm² | - |
| 空气开关输出 | 24V电源模块   | 220V  | ≤1A    | 1.0mm² | - |

### 低压系统接线表
| 源端      | 目标端        | 电压 | 电流  | 线径建议 |
|----------|--------------|------|-------|---------|
| 24V电源+ | 继电器线圈    | 24V  | 0.1A  | 0.5mm² |
| 24V电源+ | 电推杆正极    | 24V  | ≤3A   | 1.5mm² |
| 24V电源- | 系统公共地    | 0V   | -     | 1.5mm² |
| 24V电源+ | 5V降压模块    | 24V  | 0.5A  | 0.75mm²|

## 接线对照表

### MCU引脚连接表
| MCU引脚 | 功能     | 连接目标      | 信号类型 | 电平 | 备注                |
|---------|----------|---------------|----------|------|------------------|
| PA0     | 上升按钮 | 按钮1常开端   | 输入     | 3.3V | 内部上拉,按下为低电平|
| PA1     | 下降按钮 | 按钮2常开端   | 输入     | 3.3V | 内部上拉,按下为低电平|
| PA2     | 停止按钮 | 按钮3常开端   | 输入     | 3.3V | 内部上拉,按下为低电平|
| PB3     | 继电器1  | 继电器1控制端 | 输出     | 3.3V | 高电平触发          |
| PB4     | 继电器2  | 继电器2控制端 | 输出     | 3.3V | 高电平触发          |

### 电源连接表
| 源端         | 目标端      | 电压 | 电流要求 | 线径建议 |
|--------------|-------------|------|----------|----------|
| 220V交流输入 | 24V电源模块 | 220V | ≤1A     | 1.0mm²   |
| 24V电源正    | 电推杆正极  | 24V  | ≤3A     | 1.5mm²   |
| 24V电源负    | 电推杆负极  | 0V   | ≤3A     | 1.5mm²   |
| 24V电源正    | 5V降压模块  | 24V  | ≤1A     | 0.75mm²  |
| 5V输出正     | MCU电源     | 5V   | ≤0.5A   | 0.5mm²   |
| 5V输出正     | 继电器线圈  | 5V   | ≤0.1A   | 0.5mm²   |

### 继电器连接表
| 继电器端子  | 连接目标   | 电压 | 电流 | 功能说明         |
|-------------|------------|------|------|------------------|
| 继电器1 COM | 24V电源正  | 24V  | ≤3A  | 电推杆供电公共端 |
| 继电器1 NO  | 电推杆正极 | 24V  | ≤3A  | 控制电推杆正转   |
| 继电器2 COM | 24V电源负  | 0V   | ≤3A  | 电推杆地线公共端 |
| 继电器2 NO  | 电推杆负极 | 0V   | ≤3A  | 控制电推杆反转   |

### 电源输入部分
| 组件 | 规格 | 数量 | 备注 |
|------|------|------|------|
| 电源插头 | 三芯防水插头 10A/250V | 1个 | IPX4防水等级 |
| 电源线 | RVV 3×1.0mm² | 2米 | 防水护套线 |
| 漏电保护器 | 2P 16A 30mA | 1个 | 防触电保护 |
| 空气开关 | 2P 10A C型 | 1个 | 过载保护 |

### 电源防护说明
1. 防水要求
   - 所有接线端子需做防水处理
   - 控制箱接线处需密封
   - 插头连接处需有防水胶圈

2. 安全保护
   - 设备必须可靠接地
   - 漏电保护器定期测试
   - 定期检查线路绝缘

## 功能说明
1. 基本控制
   - 上升按钮：按下后电推杆上升，到达设定时间自动停止
   - 下降按钮：按下后电推杆下降，到达设定时间自动停止
   - 停止按钮：按下后立即停止运动

2. 时间控制（当前方案是通过时间来控制电推杆行进，待改进）
   - 上升时间：8秒（可通过代码调整）！！！
   - 下降时间：8秒（可通过代码调整）！！！

## 安装注意事项
1. 按键安装
   - 安装位置要便于操作
   - 按键标识要清晰
   - 接线要牢固可靠

2. 电源安装
   - 电源要有良好散热
   - 接线要使用端子固定
   - 必须可靠接地

3. 控制箱安装
   - 防水防尘
   - 通风散热
   - 便于维护

## 调试说明
1. 时间参数调整
   - 修改 UP_TIME_LIMIT 调整上升时间
   - 修改 DOWN_TIME_LIMIT 调整下降时间
   - 建议先设置较短时间进行测试

2. 运行测试
   - 空载测试电机运转
   - 测试按键功能
   - 验证自动停止功能


